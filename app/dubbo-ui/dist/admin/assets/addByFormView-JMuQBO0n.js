import{u as ve}from"./index-EJW0dQ9f.js";import{d as ye,g as he,u as _e,n as z,r as fe,f as A,c as e,t as a,e as h,o as n,y as r,v as d,h as _,a8 as ke,a9 as be,F as B,x as L,H as w,z as q,I as b,J as C,E as ge,G as Ce,_ as Me}from"./index-PIJJkkQe.js";const $=N=>(ge("data-v-c5a188bb"),N=N(),Ce(),N),Ue={class:"__container_routingRule_detail"},Te=$(()=>w("div",null," 对于服务org.apahe.dubbo.samples.UserService，将满足请求方法等于login，且该方法的第一个参数等于dubbo的请求，导向带有标签version=v1的实例 ",-1)),we=$(()=>w("br",null,null,-1)),De=$(()=>w("br",null,null,-1)),qe=$(()=>w("br",null,null,-1)),Ve=$(()=>w("br",null,null,-1)),Re=$(()=>w("br",null,null,-1)),Ke=$(()=>w("br",null,null,-1)),ze={class:"bottom-action-footer"},$e=ye({__name:"addByFormView",setup(N){he(),_e();const O=z(!1),E=z(8);ve().toClipboard;const T=fe({ruleGranularity:"application",objectOfAction:"",enable:!0,faultTolerantProtection:!0,runtime:!0}),W=z([{label:"host",value:"host"},{label:"application",value:"application"},{label:"method",value:"method"},{label:"arguments",value:"arguments"},{label:"attachments",value:"attachments"},{label:"其他",value:"other"}]),X=z([{label:"host",value:"host"},{label:"其他",value:"other"}]),V=z([{label:"=",value:"="},{label:"!=",value:"!="}]),Y=z([{label:"应用",value:"application"},{label:"服务",value:"service"}]),p=z([{selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"=",value:"127.0.0.1"},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]}]),Z=()=>{p.value.push({selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"=",value:"127.0.0.1"},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]})},m=u=>{p.value[u].requestMatch=[]},I=u=>{p.value[u].requestMatch=[{type:"host",condition:"=",value:"127.0.0.1"},{type:"application",condition:"=",value:"appName"},{type:"method",condition:"=",value:"methodName"},{type:"arguments",list:[{index:0,condition:"=",value:"arg0"}]},{type:"attachments",list:[{myKey:"key",condition:"=",value:"value"}]},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]},F=(u,t)=>{console.log(u,t),p.value[t].selectedMatchConditionTypes=p.value[t].selectedMatchConditionTypes.filter(y=>y!==u)},ee=(u,t)=>{p.value[t].selectedRouteDistributeMatchTypes=p.value[t].selectedRouteDistributeMatchTypes.filter(y=>y!==u)},le=[{dataIndex:"index",key:"index",title:"参数索引"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ae=(u,t)=>{p.value[u].requestMatch[t].list.push({index:0,condition:"=",value:""})},te=(u,t,y)=>{if(p.value[u].requestMatch[t].list.length===1){p.value[u].selectedMatchConditionTypes=p.value[u].selectedMatchConditionTypes.filter(M=>M!=="arguments");return}p.value[u].requestMatch[t].list.splice(y,1)},se=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ue=(u,t)=>{p.value[u].requestMatch[t].list.push({key:"key",condition:"=",value:""})},ne=(u,t,y)=>{if(p.value[u].requestMatch[t].list.length===1){p.value[u].selectedMatchConditionTypes=p.value[u].selectedMatchConditionTypes.filter(M=>M!=="attachments");return}p.value[u].requestMatch[t].list.splice(y,1)},H=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],oe=(u,t)=>{p.value[u].requestMatch[t].list.push({myKey:"",condition:"=",value:""})},ie=(u,t,y)=>{if(p.value[u].requestMatch[t].list.length===1){p.value[u].selectedMatchConditionTypes=p.value[u].selectedMatchConditionTypes.filter(M=>M!=="other");return}p.value[u].requestMatch[t].list.splice(y,1)},ce=(u,t)=>{p.value[u].routeDistribute[t].list.push({myKey:"",condition:"=",value:""})},de=(u,t,y)=>{if(p.value[u].routeDistribute[t].list.length===1){p.value[u].selectedRouteDistributeMatchTypes=p.value[u].selectedRouteDistributeMatchTypes.filter(M=>M!=="other");return}p.value[u].routeDistribute[t].list.splice(y,1)};return(u,t)=>{const y=h("a-button"),M=h("a-flex"),U=h("a-select"),D=h("a-form-item"),P=h("a-switch"),S=h("a-col"),g=h("a-input"),J=h("a-row"),Q=h("a-form"),K=h("a-card"),v=h("a-space"),R=h("a-tag"),j=h("a-table"),G=h("a-descriptions-item"),pe=h("a-descriptions"),re=h("a-affix");return n(),A("div",Ue,[e(M,{style:{width:"100%"}},{default:a(()=>[e(S,{span:O.value?24-E.value:24,class:"left"},{default:a(()=>[e(K,null,{default:a(()=>[e(v,{style:{width:"100%"},direction:"vertical",size:"middle"},{default:a(()=>[e(J,null,{default:a(()=>[e(M,{justify:"end",style:{width:"100%"}},{default:a(()=>[e(y,{type:"text",style:{color:"#0a90d5"},onClick:t[0]||(t[0]=i=>O.value=!O.value)},{default:a(()=>[r(" 字段说明 "),O.value?(n(),d(_(be),{key:1})):(n(),d(_(ke),{key:0}))]),_:1})]),_:1}),e(K,{title:"基础信息",style:{width:"100%"},class:"_detail"},{default:a(()=>[e(Q,{layout:"horizontal"},{default:a(()=>[e(J,{style:{width:"100%"}},{default:a(()=>[e(S,{span:12},{default:a(()=>[e(D,{label:"规则粒度",required:""},{default:a(()=>[e(U,{value:T.ruleGranularity,"onUpdate:value":t[1]||(t[1]=i=>T.ruleGranularity=i),style:{width:"120px"},options:Y.value},null,8,["value","options"])]),_:1}),e(D,{label:"容错保护"},{default:a(()=>[e(P,{checked:T.faultTolerantProtection,"onUpdate:checked":t[2]||(t[2]=i=>T.faultTolerantProtection=i),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),e(D,{label:"运行时生效"},{default:a(()=>[e(P,{checked:T.runtime,"onUpdate:checked":t[3]||(t[3]=i=>T.runtime=i),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})]),_:1}),e(S,{span:12},{default:a(()=>[e(D,{label:"作用对象",required:""},{default:a(()=>[e(g,{value:T.objectOfAction,"onUpdate:value":t[4]||(t[4]=i=>T.objectOfAction=i),style:{width:"200px"}},null,8,["value"])]),_:1}),e(D,{label:"立即启用"},{default:a(()=>[e(P,{checked:T.enable,"onUpdate:checked":t[5]||(t[5]=i=>T.enable=i),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(K,{title:"路由列表",style:{width:"100%"},class:"_detail"},{default:a(()=>[(n(!0),A(B,null,L(p.value,(i,f)=>(n(),d(K,null,{title:a(()=>[e(v,{align:"center"},{default:a(()=>[w("div",null,"路由【"+q(f+1)+"】",1),Te]),_:2},1024)]),default:a(()=>[e(Q,{layout:"horizontal"},{default:a(()=>[e(v,{style:{width:"100%"},direction:"vertical",size:"large"},{default:a(()=>[e(D,{label:"请求匹配"},{default:a(()=>[i.requestMatch.length>0?(n(),d(K,{key:0},{default:a(()=>[e(v,{style:{width:"100%"},direction:"vertical",size:"small"},{default:a(()=>[e(M,{align:"center",justify:"space-between"},{default:a(()=>[e(D,{label:"匹配条件类型"},{default:a(()=>[e(U,{value:i.selectedMatchConditionTypes,"onUpdate:value":l=>i.selectedMatchConditionTypes=l,options:W.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(_(b),{onClick:l=>m(f),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024),(n(!0),A(B,null,L(i.requestMatch,(l,k)=>(n(),A(B,null,[i.selectedMatchConditionTypes.includes("host")&&l.type==="host"?(n(),d(v,{key:0,size:"large",align:"center"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q(l==null?void 0:l.type),1)]),_:2},1024),e(U,{value:l.condition,"onUpdate:value":s=>l.condition=s,style:{"min-width":"120px"},options:V.value},null,8,["value","onUpdate:value","options"]),e(g,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,placeholder:"请求来源ip"},null,8,["modelValue","onUpdate:modelValue"]),e(_(b),{onClick:s=>F(l==null?void 0:l.type,f),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):C("",!0),i.selectedMatchConditionTypes.includes("application")&&l.type==="application"?(n(),d(v,{key:1,size:"large",align:"center"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q(l==null?void 0:l.type),1)]),_:2},1024),e(U,{value:l.condition,"onUpdate:value":s=>l.condition=s,style:{"min-width":"120px"},options:V.value},null,8,["value","onUpdate:value","options"]),e(g,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,placeholder:"请求来源应用名"},null,8,["modelValue","onUpdate:modelValue"]),e(_(b),{onClick:s=>F(l==null?void 0:l.type,f),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):C("",!0),i.selectedMatchConditionTypes.includes("method")&&l.type==="method"?(n(),d(v,{key:2,size:"large",align:"center"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q(l==null?void 0:l.type),1)]),_:2},1024),e(U,{value:l.condition,"onUpdate:value":s=>l.condition=s,style:{"min-width":"120px"},options:V.value},null,8,["value","onUpdate:value","options"]),e(g,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,placeholder:"方法值"},null,8,["modelValue","onUpdate:modelValue"]),e(_(b),{onClick:s=>F(l==null?void 0:l.type,f),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):C("",!0),i.selectedMatchConditionTypes.includes("arguments")&&l.type==="arguments"?(n(),d(v,{key:3,style:{width:"100%"},size:"large",align:"start"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q(l==null?void 0:l.type),1)]),_:2},1024),e(j,{pagination:!1,columns:le,"data-source":i.requestMatch[k].list},{bodyCell:a(({column:s,record:c,text:x})=>[s.key==="index"?(n(),d(g,{key:0,value:c.index,"onUpdate:value":o=>c.index=o,placeholder:"index"},null,8,["value","onUpdate:value"])):s.key==="condition"?(n(),d(U,{key:1,value:c.condition,"onUpdate:value":o=>c.condition=o,options:V.value},null,8,["value","onUpdate:value","options"])):s.key==="value"?(n(),d(g,{key:2,value:c.value,"onUpdate:value":o=>c.value=o,placeholder:"value"},null,8,["value","onUpdate:value"])):s.key==="operation"?(n(),d(v,{key:3,align:"center"},{default:a(()=>[e(_(b),{onClick:o=>te(f,k,u.addArgumentsItemIndex),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"]),e(_(b),{class:"action-icon",onClick:o=>ae(f,k),icon:"tdesign:add"},null,8,["onClick"])]),_:2},1024)):C("",!0)]),_:2},1032,["data-source"])]),_:2},1024)):C("",!0),i.selectedMatchConditionTypes.includes("attachments")&&l.type==="attachments"?(n(),d(v,{key:4,style:{width:"100%"},size:"large",align:"start"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q(l==null?void 0:l.type),1)]),_:2},1024),e(j,{pagination:!1,columns:se,"data-source":i.requestMatch[k].list},{bodyCell:a(({column:s,record:c,text:x})=>[s.key==="myKey"?(n(),d(g,{key:0,value:c.myKey,"onUpdate:value":o=>c.myKey=o,placeholder:"key"},null,8,["value","onUpdate:value"])):s.key==="condition"?(n(),d(U,{key:1,value:c.condition,"onUpdate:value":o=>c.condition=o,options:V.value},null,8,["value","onUpdate:value","options"])):s.key==="value"?(n(),d(g,{key:2,value:c.value,"onUpdate:value":o=>c.value=o,placeholder:"value"},null,8,["value","onUpdate:value"])):s.key==="operation"?(n(),d(v,{key:3,align:"center"},{default:a(()=>[e(_(b),{onClick:o=>ne(f,k,c.index),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"]),e(_(b),{class:"action-icon",onClick:o=>ue(f,k),icon:"tdesign:add"},null,8,["onClick"])]),_:2},1024)):C("",!0)]),_:2},1032,["data-source"])]),_:2},1024)):C("",!0),i.selectedMatchConditionTypes.includes("other")&&l.type==="other"?(n(),d(v,{key:5,style:{width:"100%"},size:"large",align:"start"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q((l==null?void 0:l.type)=="other"?"其他":l==null?void 0:l.type),1)]),_:2},1024),e(j,{pagination:!1,columns:H,"data-source":i.requestMatch[k].list},{bodyCell:a(({column:s,record:c,text:x})=>[s.key==="myKey"?(n(),d(g,{key:0,value:c.myKey,"onUpdate:value":o=>c.myKey=o,placeholder:"key"},null,8,["value","onUpdate:value"])):s.key==="condition"?(n(),d(U,{key:1,value:c.condition,"onUpdate:value":o=>c.condition=o,options:V.value},null,8,["value","onUpdate:value","options"])):s.key==="value"?(n(),d(g,{key:2,value:c.value,"onUpdate:value":o=>c.value=o,placeholder:"value"},null,8,["value","onUpdate:value"])):s.key==="operation"?(n(),d(v,{key:3,align:"center"},{default:a(()=>[e(_(b),{onClick:o=>ie(f,k,c.index),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"]),e(_(b),{onClick:o=>oe(f,k),icon:"tdesign:add",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):C("",!0)]),_:2},1032,["data-source"])]),_:2},1024)):C("",!0)],64))),256))]),_:2},1024)]),_:2},1024)):(n(),d(y,{key:1,onClick:l=>I(f),type:"dashed",size:"large"},{icon:a(()=>[e(_(b),{icon:"tdesign:add"})]),default:a(()=>[r(" 增加匹配条件 ")]),_:2},1032,["onClick"]))]),_:2},1024),e(D,{label:"路由分发",required:""},{default:a(()=>[e(K,null,{default:a(()=>[e(v,{style:{width:"100%"},direction:"vertical",size:"small"},{default:a(()=>[e(M,null,{default:a(()=>[e(D,{label:"匹配条件类型"},{default:a(()=>[e(U,{value:i.selectedRouteDistributeMatchTypes,"onUpdate:value":l=>i.selectedRouteDistributeMatchTypes=l,options:X.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),(n(!0),A(B,null,L(i.routeDistribute,(l,k)=>(n(),A(B,{key:k},[i.selectedRouteDistributeMatchTypes.includes("host")&&l.type==="host"?(n(),d(v,{key:0,size:"large",align:"center"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q(l==null?void 0:l.type),1)]),_:2},1024),e(U,{value:l.condition,"onUpdate:value":s=>l.condition=s,style:{"min-width":"120px"},options:V.value},null,8,["value","onUpdate:value","options"]),e(g,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,placeholder:"请求来源ip"},null,8,["modelValue","onUpdate:modelValue"]),e(_(b),{onClick:s=>ee(l==null?void 0:l.type,f),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):C("",!0),i.selectedRouteDistributeMatchTypes.includes("other")&&l.type==="other"?(n(),d(v,{key:1,style:{width:"100%"},size:"large",align:"start"},{default:a(()=>[e(R,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:a(()=>[r(q((l==null?void 0:l.type)=="other"?"其他":l==null?void 0:l.type),1)]),_:2},1024),e(j,{pagination:!1,columns:H,"data-source":i.routeDistribute[k].list},{bodyCell:a(({column:s,record:c,text:x})=>[s.key==="myKey"?(n(),d(g,{key:0,value:c.myKey,"onUpdate:value":o=>c.myKey=o,placeholder:"key"},null,8,["value","onUpdate:value"])):s.key==="condition"?(n(),d(U,{key:1,value:c.condition,"onUpdate:value":o=>c.condition=o,options:V.value},null,8,["value","onUpdate:value","options"])):s.key==="value"?(n(),d(g,{key:2,value:c.value,"onUpdate:value":o=>c.value=o,placeholder:"value"},null,8,["value","onUpdate:value"])):s.key==="operation"?(n(),d(v,{key:3,align:"center"},{default:a(()=>[e(_(b),{onClick:o=>de(f,k,c.index),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"]),e(_(b),{onClick:o=>ce(f,k),icon:"tdesign:add",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):C("",!0)]),_:2},1032,["data-source"])]),_:2},1024)):C("",!0)],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(y,{onClick:Z,type:"primary"},{default:a(()=>[r(" 增加路由 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["span"]),e(S,{span:O.value?E.value:0,class:"right"},{default:a(()=>[O.value?(n(),d(K,{key:0,class:"sliderBox"},{default:a(()=>[w("div",null,[e(pe,{title:"字段说明",column:1},{default:a(()=>[e(G,{label:"key"},{default:a(()=>[r(" 作用对象"),we,r(" 可能的值：Dubbo应用名或者服务名 ")]),_:1}),e(G,{label:"scope"},{default:a(()=>[r(" 规则粒度"),De,r(" 可能的值：application, service ")]),_:1}),e(G,{label:"force"},{default:a(()=>[r(" 容错保护"),qe,r(" 可能的值：true, false"),Ve,r(" 描述：如果为true，则路由筛选后若没有可用的地址则会直接报异常；如果为false，则会从可用地址中选择完成RPC调用 ")]),_:1}),e(G,{label:"runtime"},{default:a(()=>[r(" 运行时生效"),Re,r(" 可能的值：true, false"),Ke,r(" 描述：如果为true，则该rule下的所有路由将会实时生效；若为false，则只有在启动时才会生效 ")]),_:1})]),_:1})])]),_:1})):C("",!0)]),_:1},8,["span"])]),_:1}),e(re,{"offset-bottom":10},{default:a(()=>[w("div",ze,[e(v,{align:"center",size:"large"},{default:a(()=>[e(y,{type:"primary"},{default:a(()=>[r(" 确认 ")]),_:1}),e(y,null,{default:a(()=>[r(" 取消 ")]),_:1})]),_:1})])]),_:1})])}}}),Be=Me($e,[["__scopeId","data-v-c5a188bb"]]);export{Be as default};
